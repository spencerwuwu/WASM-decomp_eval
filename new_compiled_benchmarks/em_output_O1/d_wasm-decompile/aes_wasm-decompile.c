import memory env_memory;

import global stack_pointer:int;
import global memory_base:int;
import global table_base:int;
export import global nb:int;
export import global round_val:int;
export import global word:int;
export import global main_result:int;
export import global Sbox:int;
export import global Rcon0:int;
export import global invSbox:int;
export import global statemt:int;
export import global key:int;
export import global startTimer:int;
export import global endTimer:int;
global nb_1:int = 2356;
global round_val_1:int = 2352;
global word_1:int = 2368;
global main_result_1:int = 2360;
global Sbox_1:int = 256;
global Rcon0_1:int = 128;
global invSbox_1:int = 1280;
global statemt_1:int = 4288;
global key_1:int = 4416;
global startTimer_1:int = 4544;
global endTimer_1:int = 4552;
export global type:int = 4560;

data data(offset: memory_base) =
  "9\00\00\00%\00\00\00\84\00\00\00\1d\00\00\00\02\00\00\00\dc\00\00\00\09"
  "\00\00\00\fb\00\00\00\dc\00\00\00\11\00\00\00\85\00\00\00\97\00\00\00\19"
  "\00\00\00j\00\00\00\0b\00\00\002\00\00\002\00\00\00C\00\00\00\f6\00\00"
  "\00\a8\00\00\00\88\00\00\00Z\00\00\000\00\00\00\8d\00\00\001\00\00\001"
  "\00\00\00\98\00\00\00\a2\00\00\00\e0\00\00\007\00\00\00\07\00\00\004\00"
  "\00\00\01\00\00\00\02\00\00\00\04\00\00\00\08\00\00\00\10\00\00\00 \00"
  "\00\00@\00\00\00\80\00\00\00\1b\00\00\006\00\00\00l\00\00\00\d8\00\00\00"
  "\ab\00\00\00M\00\00\00\9a\00\00\00/\00\00\00^\00\00\00\bc\00\00\00c\00"
  "\00\00\c6\00\00\00\97\00\00\005\00\00\00j\00\00\00\d4\00\00\00\b3\00\00"
  "\00}\00\00\00\fa\00\00\00\ef\00\00\00\c5\00\00\00\91\00\00\00\00\00\00"
  "\00\00\00\00\00c\00\00\00|\00\00\00w\00\00\00{\00\00\00\f2\00\00\00k\00"
  "\00\00o\00\00\00\c5\00\00\000\00\00\00\01\00\00\00g\00\00\00+\00\00\00"
  "\fe\00\00\00\d7\00\00\00\ab\00\00\00v\00\00\00\ca\00\00\00\82\00\00\00"
  "\c9\00\00\00}\00\00\00\fa\00\00\00Y\00\00\00G\00\00\00\f0\00\00\00\ad\00"
  "\00\00\d4\00\00\00\a2\00\00\00\af\00\00\00\9c\00\00\00\a4\00\00\00r\00"
  "\00\00\c0\00\00\00\b7\00\00\00\fd\00\00\00\93\00\00\00&\00\00\006\00\00"
  "\00?\00\00\00\f7\00\00\00\cc\00\00\004\00\00\00\a5\00\00\00\e5\00\00\00"
  "\f1\00\00\00q\00\00\00\d8\00\00\001\00\00\00\15\00\00\00\04\00\00\00\c7"
  "\00\00\00#\00\00\00\c3\00\00\00\18\00\00\00\96\00\00\00\05\00\00\00\9a"
  "\00\00\00\07\00\00\00\12\00\00\00\80\00\00\00\e2\00\00\00\eb\00\00\00'"
  "\00\00\00\b2\00\00\00u\00\00\00\09\00\00\00\83\00\00\00,\00\00\00\1a\00"
  "\00\00\1b\00\00\00n\00\00\00Z\00\00\00\a0\00\00\00R\00\00\00;\00\00\00"
  "\d6\00\00\00\b3\00\00\00)\00\00\00\e3\00\00\00/\00\00\00\84\00\00\00S\00"
  "\00\00\d1\00\00\00\00\00\00\00\ed\00\00\00 \00\00\00\fc\00\00\00\b1\00"
  "\00\00[\00\00\00j\00\00\00\cb\00\00\00\be\00\00\009\00\00\00J\00\00\00"
  "L\00\00\00X\00\00\00\cf\00\00\00\d0\00\00\00\ef\00\00\00\aa\00\00\00\fb"
  "\00\00\00C\00\00\00M\00\00\003\00\00\00\85\00\00\00E\00\00\00\f9\00\00"
  "\00\02\00\00\00\7f\00\00\00P\00\00\00<\00\00\00\9f\00\00\00\a8\00\00\00"
  "Q\00\00\00\a3\00\00\00@\00\00\00\8f\00\00\00\92\00\00\00\9d\00\00\008\00"
  "\00\00\f5\00\00\00\bc\00\00\00\b6\00\00\00\da\00\00\00!\00\00\00\10\00"
  "\00\00\ff\00\00\00\f3\00\00\00\d2\00\00\00\cd\00\00\00\0c\00\00\00\13\00"
  "\00\00\ec\00\00\00_\00\00\00\97\00\00\00D\00\00\00\17\00\00\00\c4\00\00"
  "\00\a7\00\00\00~\00\00\00=\00\00\00d\00\00\00]\00\00\00\19\00\00\00s\00"
  "\00\00`\00\00\00\81\00\00\00O\00\00\00\dc\00\00\00"\00\00\00*\00\00\00"
  "\90\00\00\00\88\00\00\00F\00\00\00\ee\00\00\00\b8\00\00\00\14\00\00\00"
  "\de\00\00\00^\00\00\00\0b\00\00\00\db\00\00\00\e0\00\00\002\00\00\00:\00"
  "\00\00\0a\00\00\00I\00\00\00\06\00\00\00$\00\00\00\\00\00\00\c2\00\00\00"
  "\d3\00\00\00\ac\00\00\00b\00\00\00\91\00\00\00\95\00\00\00\e4\00\00\00"
  "y\00\00\00\e7\00\00\00\c8\00\00\007\00\00\00m\00\00\00\8d\00\00\00\d5\00"
  "\00\00N\00\00\00\a9\00\00\00l\00\00\00V\00\00\00\f4\00\00\00\ea\00\00\00"
  "e\00\00\00z\00\00\00\ae\00\00\00\08\00\00\00\ba\00\00\00x\00\00\00%\00"
  "\00\00.\00\00\00\1c\00\00\00\a6\00\00\00\b4\00\00\00\c6\00\00\00\e8\00"
  "\00\00\dd\00\00\00t\00\00\00\1f\00\00\00K\00\00\00\bd\00\00\00\8b\00\00"
  "\00\8a\00\00\00p\00\00\00>\00\00\00\b5\00\00\00f\00\00\00H\00\00\00\03"
  "\00\00\00\f6\00\00\00\0e\00\00\00a\00\00\005\00\00\00W\00\00\00\b9\00\00"
  "\00\86\00\00\00\c1\00\00\00\1d\00\00\00\9e\00\00\00\e1\00\00\00\f8\00\00"
  "\00\98\00\00\00\11\00\00\00i\00\00\00\d9\00\00\00\8e\00\00\00\94\00\00"
  "\00\9b\00\00\00\1e\00\00\00\87\00\00\00\e9\00\00\00\ce\00\00\00U\00\00"
  "\00(\00\00\00\df\00\00\00\8c\00\00\00\a1\00\00\00\89\00\00\00\0d\00\00"
  "\00\bf\00\00\00\e6\00\00\00B\00\00\00h\00\00\00A\00\00\00\99\00\00\00-"
  "\00\00\00\0f\00\00\00\b0\00\00\00T\00\00\00\bb\00\00\00\16\00\00\00R\00"
  "\00\00\09\00\00\00j\00\00\00\d5\00\00\000\00\00\006\00\00\00\a5\00\00\00"
  "8\00\00\00\bf\00\00\00@\00\00\00\a3\00\00\00\9e\00\00\00\81\00\00\00\f3"
  "\00\00\00\d7\00\00\00\fb\00\00\00|\00\00\00\e3\00\00\009\00\00\00\82\00"
  "\00\00\9b\00\00\00/\00\00\00\ff\00\00\00\87\00\00\004\00\00\00\8e\00\00"
  "\00C\00\00\00D\00\00\00\c4\00\00\00\de\00\00\00\e9\00\00\00\cb\00\00\00"
  "T\00\00\00{\00\00\00\94\00\00\002\00\00\00\a6\00\00\00\c2\00\00\00#\00"
  "\00\00=\00\00\00\ee\00\00\00L\00\00\00\95\00\00\00\0b\00\00\00B\00\00\00"
  "\fa\00\00\00\c3\00\00\00N\00\00\00\08\00\00\00.\00\00\00\a1\00\00\00f\00"
  "\00\00(\00\00\00\d9\00\00\00$\00\00\00\b2\00\00\00v\00\00\00[\00\00\00"
  "\a2\00\00\00I\00\00\00m\00\00\00\8b\00\00\00\d1\00\00\00%\00\00\00r\00"
  "\00\00\f8\00\00\00\f6\00\00\00d\00\00\00\86\00\00\00h\00\00\00\98\00\00"
  "\00\16\00\00\00\d4\00\00\00\a4\00\00\00\\00\00\00\cc\00\00\00]\00\00\00"
  "e\00\00\00\b6\00\00\00\92\00\00\00l\00\00\00p\00\00\00H\00\00\00P\00\00"
  "\00\fd\00\00\00\ed\00\00\00\b9\00\00\00\da\00\00\00^\00\00\00\15\00\00"
  "\00F\00\00\00W\00\00\00\a7\00\00\00\8d\00\00\00\9d\00\00\00\84\00\00\00"
  "\90\00\00\00\d8\00\00\00\ab\00\00\00\00\00\00\00\8c\00\00\00\bc\00\00\00"
  "\d3\00\00\00\0a\00\00\00\f7\00\00\00\e4\00\00\00X\00\00\00\05\00\00\00"
  "\b8\00\00\00\b3\00\00\00E\00\00\00\06\00\00\00\d0\00\00\00,\00\00\00\1e"
  "\00\00\00\8f\00\00\00\ca\00\00\00?\00\00\00\0f\00\00\00\02\00\00\00\c1"
  "\00\00\00\af\00\00\00\bd\00\00\00\03\00\00\00\01\00\00\00\13\00\00\00\8a"
  "\00\00\00k\00\00\00:\00\00\00\91\00\00\00\11\00\00\00A\00\00\00O\00\00"
  "\00g\00\00\00\dc\00\00\00\ea\00\00\00\97\00\00\00\f2\00\00\00\cf\00\00"
  "\00\ce\00\00\00\f0\00\00\00\b4\00\00\00\e6\00\00\00s\00\00\00\96\00\00"
  "\00\ac\00\00\00t\00\00\00"\00\00\00\e7\00\00\00\ad\00\00\005\00\00\00\85"
  "\00\00\00\e2\00\00\00\f9\00\00\007\00\00\00\e8\00\00\00\1c\00\00\00u\00"
  "\00\00\df\00\00\00n\00\00\00G\00\00\00\f1\00\00\00\1a\00\00\00q\00\00\00"
  "\1d\00\00\00)\00\00\00\c5\00\00\00\89\00\00\00o\00\00\00\b7\00\00\00b\00"
  "\00\00\0e\00\00\00\aa\00\00\00\18\00\00\00\be\00\00\00\1b\00\00\00\fc\00"
  "\00\00V\00\00\00>\00\00\00K\00\00\00\c6\00\00\00\d2\00\00\00y\00\00\00"
  " \00\00\00\9a\00\00\00\db\00\00\00\c0\00\00\00\fe\00\00\00x\00\00\00\cd"
  "\00\00\00Z\00\00\00\f4\00\00\00\1f\00\00\00\dd\00\00\00\a8\00\00\003\00"
  "\00\00\88\00\00\00\07\00\00\00\c7\00\00\001\00\00\00\b1\00\00\00\12\00"
  "\00\00\10\00\00\00Y\00\00\00'\00\00\00\80\00\00\00\ec\00\00\00_\00\00\00"
  "`\00\00\00Q\00\00\00\7f\00\00\00\a9\00\00\00\19\00\00\00\b5\00\00\00J\00"
  "\00\00\0d\00\00\00-\00\00\00\e5\00\00\00z\00\00\00\9f\00\00\00\93\00\00"
  "\00\c9\00\00\00\9c\00\00\00\ef\00\00\00\a0\00\00\00\e0\00\00\00;\00\00"
  "\00M\00\00\00\ae\00\00\00*\00\00\00\f5\00\00\00\b0\00\00\00\c8\00\00\00"
  "\eb\00\00\00\bb\00\00\00<\00\00\00\83\00\00\00S\00\00\00\99\00\00\00a\00"
  "\00\00\17\00\00\00+\00\00\00\04\00\00\00~\00\00\00\ba\00\00\00w\00\00\00"
  "\d6\00\00\00&\00\00\00\e1\00\00\00i\00\00\00\14\00\00\00c\00\00\00U\00"
  "\00\00!\00\00\00\0c\00\00\00}\00\00\00Error return from gettimeofday: "
  "%d\00%0.6f\0a\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
  "\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00";

import function gettimeofday(a:int, b:int):int;

import function iprintf(a:int, b:int):int;

import function small_printf(a:int, b:int):int;

export function wasm_call_ctors() {
}

export function wasm_apply_data_relocs() {
}

export function encrypt(a:int, b:int_ptr, c:int):int {
  var d:int_ptr;
  var f:int;
  var g:int_ptr;
  KeySchedule(c, b);
  if (c > 192191) goto B_h;
  if (c > 128255) goto B_i;
  b = 0;
  d = 4;
  if (c == 128128) goto B_b;
  if (c == 128192) goto B_e;
  b = 4;
  goto B_a;
  label B_i:
  if (c == 128256) goto B_c;
  if (c == 192128) goto B_g;
  b = 4;
  goto B_a;
  label B_h:
  if (c > 256127) goto B_j;
  if (c == 192192) goto B_e;
  if (c == 192256) goto B_c;
  b = 4;
  goto B_a;
  label B_j:
  if (c == 256128) goto B_f;
  if (c == 256192) goto B_d;
  if (c == 256256) goto B_c;
  b = 4;
  goto B_a;
  label B_g:
  b = 2;
  d = 4;
  goto B_b;
  label B_f:
  b = 4;
  d = 4;
  goto B_b;
  label B_e:
  b = 2;
  d = 6;
  goto B_b;
  label B_d:
  b = 4;
  d = 6;
  goto B_b;
  label B_c:
  b = 4;
  d = 8;
  label B_b:
  nb[0]:int = d;
  round_val[0]:int = b;
  if (c > 192255) goto B_m;
  if (c == 128192) goto B_l;
  if (c == 128256) goto B_k;
  b = 4;
  if (c == 192192) goto B_l;
  goto B_a;
  label B_m:
  if (c == 192256) goto B_k;
  if (c == 256256) goto B_k;
  b = 4;
  if (c != 256192) goto B_a;
  label B_l:
  b = 6;
  goto B_a;
  label B_k:
  b = 8;
  label B_a:
  var e:int = b;
  b = 0;
  loop L_n {
    d = word;
    b = a + ((f = b) << 4);
    b[0] = b[0] ^ (d = d + (f << 2))[0];
    g = b + 4;
    g[0] = g[0] ^ (d + 480)[0]:int;
    g = b + 8;
    g[0] = g[0] ^ (d + 960)[0]:int;
    b = b + 12;
    b[0] = b[0] ^ (d + 1440)[0]:int;
    d = f + 1;
    b = d;
    if (d != e) continue L_n;
  }
  if (round_val[0]:int >= -8) goto B_p;
  f = 1;
  goto B_o;
  label B_p:
  d = 1;
  loop L_q {
    ByteSub_ShiftRow(a, (b = nb)[0]);
    MixColumn_AddRoundKey(a, b[0], b = d);
    f = b + 1;
    d = f;
    f = f;
    if (b < round_val[0]:int + 9) continue L_q;
  }
  label B_o:
  d = f;
  ByteSub_ShiftRow(a, nb[0]:int);
  if (c > 192255) goto B_u;
  if (c == 128192) goto B_t;
  if (c == 128256) goto B_s;
  b = 4;
  if (c == 192192) goto B_t;
  goto B_r;
  label B_u:
  if (c == 192256) goto B_s;
  if (c == 256256) goto B_s;
  b = 4;
  if (c != 256192) goto B_r;
  label B_t:
  b = 6;
  goto B_r;
  label B_s:
  b = 8;
  label B_r:
  e = b;
  c = e * d;
  b = 0;
  loop L_v {
    b = a + ((f = b) << 4);
    b[0] = b[0] ^ (d = word + (f + c << 2))[0];
    g = b + 4;
    g[0] = g[0] ^ (d + 480)[0]:int;
    g = b + 8;
    g[0] = g[0] ^ (d + 960)[0]:int;
    b = b + 12;
    b[0] = b[0] ^ (d + 1440)[0]:int;
    d = f + 1;
    b = d;
    if (d != e) continue L_v;
  }
  b = 0;
  d = main_result[0]:int;
  loop L_w {
    g = (memory_base + 0 + (f = (b = b) << 2))[0]:int;
    f = (a + f)[0]:int;
    main_result[0]:int = (d = d + (f != g));
    f = b + 1;
    b = f;
    d = d;
    if (f != 16) continue L_w;
  }
  return 0;
}

export function KeySchedule(a:int_ptr, b:int_ptr):int {
  var f:int;
  var e:int;
  var d:int;
  var l:int;
  var c:{ a:int, b:int, c:int, d:int } = stack_pointer - 16;
  if (a > 192191) goto B_h;
  if (a > 128255) goto B_i;
  if (a != 128128) goto B_g;
  a = 0;
  d = 4;
  e = 4;
  f = 11;
  goto B_b;
  label B_i:
  if (a == 128256) goto B_f;
  d = -1;
  if (a != 192128) goto B_a;
  a = 0;
  d = 6;
  e = 4;
  f = 13;
  goto B_b;
  label B_h:
  if (a > 256127) goto B_j;
  if (a == 192192) goto B_e;
  d = -1;
  if (a != 192256) goto B_a;
  a = 0;
  d = 6;
  e = 8;
  f = 15;
  goto B_b;
  label B_j:
  if (a == 256128) goto B_d;
  if (a == 256192) goto B_c;
  d = -1;
  if (a != 256256) goto B_a;
  a = 1;
  d = 8;
  e = 8;
  f = 15;
  goto B_b;
  label B_g:
  d = -1;
  if (a != 128192) goto B_a;
  a = 0;
  d = 4;
  e = 6;
  f = 13;
  goto B_b;
  label B_f:
  a = 0;
  d = 4;
  e = 8;
  f = 15;
  goto B_b;
  label B_e:
  a = 0;
  d = 6;
  e = 6;
  f = 13;
  goto B_b;
  label B_d:
  a = 1;
  d = 8;
  e = 4;
  f = 15;
  goto B_b;
  label B_c:
  a = 1;
  d = 8;
  e = 6;
  f = 15;
  label B_b:
  var g:int = f;
  var h:int = e;
  var i:int = d;
  var j:int = a;
  a = 0;
  loop L_k {
    f = a;
    d = f << 2;
    a = 0;
    loop L_l {
      (word + (a = a) * 480 + d)[0]:int = b[a + d]:int;
      e = a + 1;
      a = e;
      if (e != 4) continue L_l;
    }
    d = f + 1;
    a = d;
    if (d != i) continue L_k;
  }
  var k:int = g * h;
  j = j ^ 1;
  a = i;
  loop L_m {
    e = a;
    a = e + -1;
    d = e - (f = e / i) * i;
    if (d) goto B_o;
    b = word + (a << 2);
    g = (b + 960)[0]:int;
    a = Sbox;
    h = (b + 480)[0]:int;
    c.b = (a + ((l = g / 16) << 6))[g - (l << 4)]:int;
    c.c =
      (a + ((l = (g = (b + 1440)[0]:int) / 16) << 6))[g - (l << 4)]:int;
    c.a =
      (a + ((g = h / 16) << 6))[h - (g << 4)]:int ^
      ((f << 2) + Rcon0 + -4)[0]:int;
    a = a + ((f = (b = b[0]) / 16) << 6) + (b - (f << 4) << 2);
    goto B_n;
    label B_o:
    c.a = (a = word + (a << 2))[0];
    c.b = (a + 480)[0]:int;
    c.c = (a + 960)[0]:int;
    a = a + 1440;
    label B_n:
    c.d = a[0];
    a = 0;
    if (j | d != 4) goto B_p;
    loop L_q {
      b = c + ((d = a) << 2);
      a = b[0];
      b[0] = (Sbox + ((f = a / 16) << 6))[a - (f << 4)]:int;
      d = d + 1;
      a = d;
      if (d != 4) continue L_q;
    }
    label B_p:
    b = e - i;
    a = 0;
    loop L_r {
      d = word + (a = a) * 480;
      d[e]:int = c[a]:int ^ d[b]:int;
      d = a + 1;
      a = d;
      if (d != 4) continue L_r;
    }
    d = e + 1;
    a = d;
    if (d != k) continue L_m;
  }
  d = 0;
  label B_a:
  return d;
}

export function ByteSub_ShiftRow(a:int_ptr, b:int_ptr) {
  var e:int;
  var c:int;
  var d:int;
  br_table[B_e, B_a, B_d, B_a, B_c, ..B_a](b + -4)
  label B_e:
  c = a[5];
  b = Sbox;
  d = a[1];
  a[1] = (b + (c << 2 & -64))[c & 15]:int;
  c = a[9];
  a[9] = (b + ((e = a[13]) << 2 & -64))[e & 15]:int;
  a[5] = (b + (c << 2 & -64))[c & 15]:int;
  a[13] = (b + (d << 2 & -64))[d & 15]:int;
  c = a[2];
  a[2] = (b + ((d = a[10]) << 2 & -64))[d & 15]:int;
  a[10] = (b + (c << 2 & -64))[c & 15]:int;
  c = a[6];
  a[6] = (b + ((d = a[14]) << 2 & -64))[d & 15]:int;
  a[14] = (b + (c << 2 & -64))[c & 15]:int;
  c = a[3];
  a[3] = (b + ((d = a[15]) << 2 & -64))[d & 15]:int;
  a[15] = (b + ((d = a[11]) << 2 & -64))[d & 15]:int;
  d = a[7];
  a[7] = (b + (c << 2 & -64))[c & 15]:int;
  a[11] = (b + (d << 2 & -64))[d & 15]:int;
  a[0] = (b + ((c = a[0]) << 2 & -64))[c & 15]:int;
  a[4] = (b + ((c = a[4]) << 2 & -64))[c & 15]:int;
  a[8] = (b + ((c = a[8]) << 2 & -64))[c & 15]:int;
  a = a + 48;
  goto B_b;
  label B_d:
  c = a[5];
  b = Sbox;
  d = a[1];
  a[1] = (b + (c << 2 & -64))[c & 15]:int;
  c = a[9];
  a[9] = (b + ((e = a[13]) << 2 & -64))[e & 15]:int;
  a[5] = (b + (c << 2 & -64))[c & 15]:int;
  a[13] = (b + ((c = a[17]) << 2 & -64))[c & 15]:int;
  a[17] = (b + ((c = a[21]) << 2 & -64))[c & 15]:int;
  a[21] = (b + (d << 2 & -64))[d & 15]:int;
  c = a[2];
  a[2] = (b + ((d = a[10]) << 2 & -64))[d & 15]:int;
  a[10] = (b + ((d = a[18]) << 2 & -64))[d & 15]:int;
  a[18] = (b + (c << 2 & -64))[c & 15]:int;
  c = a[6];
  a[6] = (b + ((d = a[14]) << 2 & -64))[d & 15]:int;
  d = a[22];
  a[22] = (b + (c << 2 & -64))[c & 15]:int;
  a[14] = (b + (d << 2 & -64))[d & 15]:int;
  c = a[15];
  a[15] = (b + ((d = a[3]) << 2 & -64))[d & 15]:int;
  a[3] = (b + (c << 2 & -64))[c & 15]:int;
  c = a[19];
  a[19] = (b + ((d = a[7]) << 2 & -64))[d & 15]:int;
  a[7] = (b + (c << 2 & -64))[c & 15]:int;
  c = a[23];
  a[23] = (b + ((d = a[11]) << 2 & -64))[d & 15]:int;
  a[11] = (b + (c << 2 & -64))[c & 15]:int;
  a[0] = (b + ((c = a[0]) << 2 & -64))[c & 15]:int;
  a[4] = (b + ((c = a[4]) << 2 & -64))[c & 15]:int;
  a[8] = (b + ((c = a[8]) << 2 & -64))[c & 15]:int;
  a[12] = (b + ((c = a[12]) << 2 & -64))[c & 15]:int;
  a[16] = (b + ((c = a[16]) << 2 & -64))[c & 15]:int;
  a = a + 80;
  goto B_b;
  label B_c:
  c = a[5];
  b = Sbox;
  d = a[1];
  a[1] = (b + (c << 2 & -64))[c & 15]:int;
  c = a[9];
  a[9] = (b + ((e = a[13]) << 2 & -64))[e & 15]:int;
  a[5] = (b + (c << 2 & -64))[c & 15]:int;
  a[13] = (b + ((c = a[17]) << 2 & -64))[c & 15]:int;
  a[17] = (b + ((c = a[21]) << 2 & -64))[c & 15]:int;
  a[21] = (b + ((c = a[25]) << 2 & -64))[c & 15]:int;
  a[25] = (b + ((c = a[29]) << 2 & -64))[c & 15]:int;
  a[29] = (b + (d << 2 & -64))[d & 15]:int;
  c = a[2];
  a[2] = (b + ((d = a[14]) << 2 & -64))[d & 15]:int;
  a[14] = (b + ((d = a[26]) << 2 & -64))[d & 15]:int;
  a[26] = (b + ((d = a[6]) << 2 & -64))[d & 15]:int;
  a[6] = (b + ((d = a[18]) << 2 & -64))[d & 15]:int;
  a[18] = (b + ((d = a[30]) << 2 & -64))[d & 15]:int;
  a[30] = (b + ((d = a[10]) << 2 & -64))[d & 15]:int;
  d = a[22];
  a[22] = (b + (c << 2 & -64))[c & 15]:int;
  a[10] = (b + (d << 2 & -64))[d & 15]:int;
  c = a[19];
  a[19] = (b + ((d = a[3]) << 2 & -64))[d & 15]:int;
  a[3] = (b + (c << 2 & -64))[c & 15]:int;
  c = a[23];
  a[23] = (b + ((d = a[7]) << 2 & -64))[d & 15]:int;
  a[7] = (b + (c << 2 & -64))[c & 15]:int;
  c = a[27];
  a[27] = (b + ((d = a[11]) << 2 & -64))[d & 15]:int;
  a[11] = (b + (c << 2 & -64))[c & 15]:int;
  c = a[31];
  a[31] = (b + ((d = a[15]) << 2 & -64))[d & 15]:int;
  a[15] = (b + (c << 2 & -64))[c & 15]:int;
  a[0] = (b + ((c = a[0]) << 2 & -64))[c & 15]:int;
  a[4] = (b + ((c = a[4]) << 2 & -64))[c & 15]:int;
  a[8] = (b + ((c = a[8]) << 2 & -64))[c & 15]:int;
  a[12] = (b + ((c = a[12]) << 2 & -64))[c & 15]:int;
  a[16] = (b + ((c = a[16]) << 2 & -64))[c & 15]:int;
  a[20] = (b + ((c = a[20]) << 2 & -64))[c & 15]:int;
  a[24] = (b + ((c = a[24]) << 2 & -64))[c & 15]:int;
  a = a + 112;
  label B_b:
  b = a;
  a = b[0];
  b[0] = (Sbox + (a << 2 & -64))[a & 15]:int;
  label B_a:
}

export function MixColumn_AddRoundKey(a:int, b:int, c:int):int {
  var f:int;
  var h:int;
  var i:int;
  var j:int;
  var k:int;
  var l:int;
  var m:int;
  var n:int_ptr;
  var o:int;
  var p:int;
  var q:int;
  var d:int = stack_pointer - 128;
  if (b < 1) goto B_a;
  var e:int = c * b;
  c = 0;
  loop L_b {
    var g:int_ptr = d + (c = (f = c) << 4);
    g[0] =
      (j = select_if((i = (h = (a + c)[0]:int) << 1) ^ 283,
                     i,
                     (h & 2147483520) == 128));
    g[0] =
      (o = 
         select_if(
           (j = (n = (m = (l = (a + (k = c | 4))[0]:int) << 1) ^ l) ^ j) ^ 283,
           j,
           (n & -256) == 256));
    n = word;
    g[0] =
      (((j = (a + (p = c | 8))[0]:int) ^ (n = n + (f + e << 2))[0]) ^
       (c = (a + (q = c | 12))[0]:int)) ^
      o;
    (d + k)[0]:int =
      (c ^ (h ^ (n + 480)[0]:int)) ^
      select_if((m = (k = j ^ (g = j << 1)) ^
                     select_if(m ^ 283, m, (l & 2147483520) == 128)) ^
                283,
                m,
                (k & -256) == 256);
    (d + p)[0]:int =
      (l ^ (h ^ (n + 960)[0]:int)) ^
      select_if((g = (k = c ^ (m = c << 1)) ^
                     select_if(g ^ 283, g, (j & 2147483520) == 128)) ^
                283,
                g,
                (k & -256) == 256);
    (d + q)[0]:int =
      (j ^ (l ^ (n + 1440)[0]:int)) ^
      select_if(
        (h = select_if(m ^ 283, m, (c & 2147483520) == 128) ^ (c = i ^ h)) ^
        283,
        h,
        (c & -256) == 256);
    h = f + 1;
    c = h;
    if (h != b) continue L_b;
  }
  label B_a:
  if (b <= 0) goto B_c;
  c = 0;
  loop L_d {
    (a + (c = (h = c) << 4))[0]:int = (d + c)[0]:int;
    (a + (l = c | 4))[0]:int = (d + l)[0]:int;
    (a + (l = c | 8))[0]:int = (d + l)[0]:int;
    (a + (c = c | 12))[0]:int = (d + c)[0]:int;
    h = h + 1;
    c = h;
    if (h != b) continue L_d;
  }
  label B_c:
  return 0;
}

export function AddRoundKey(a:int, b:int_ptr, c:int):int {
  var d:int_ptr;
  if (b > 192255) goto B_d;
  if (b == 128192) goto B_c;
  if (b == 128256) goto B_b;
  d = 4;
  if (b == 192192) goto B_c;
  goto B_a;
  label B_d:
  if (b == 192256) goto B_b;
  if (b == 256256) goto B_b;
  d = 4;
  if (b != 256192) goto B_a;
  label B_c:
  d = 6;
  goto B_a;
  label B_b:
  d = 8;
  label B_a:
  var e:int = d;
  var f:int = e * c;
  b = 0;
  loop L_e {
    b = a + ((c = b) << 4);
    b[0] = b[0] ^ (d = word + (c + f << 2))[0];
    var g:int_ptr = b + 4;
    g[0] = g[0] ^ (d + 480)[0]:int;
    g = b + 8;
    g[0] = g[0] ^ (d + 960)[0]:int;
    b = b + 12;
    b[0] = b[0] ^ (d + 1440)[0]:int;
    d = c + 1;
    b = d;
    if (d != e) continue L_e;
  }
  return 0;
}

export function decrypt(a:int, b:int_ptr, c:int):int {
  var d:int_ptr;
  var g:int;
  var h:int_ptr;
  KeySchedule(c, b);
  if (c > 192191) goto B_f;
  if (c > 128255) goto B_g;
  b = 10;
  d = 4;
  if (c == 128128) goto B_b;
  if (c != 128192) goto B_a;
  goto B_c;
  label B_g:
  if (c == 128256) goto B_e;
  if (c != 192128) goto B_a;
  b = 12;
  d = 4;
  goto B_b;
  label B_f:
  if (c > 256127) goto B_d;
  if (c == 192192) goto B_c;
  if (c != 192256) goto B_a;
  label B_e:
  b = 14;
  d = 8;
  goto B_b;
  label B_d:
  if (c == 256128) goto B_i;
  if (c == 256192) goto B_h;
  if (c != 256256) goto B_a;
  b = 14;
  d = 8;
  goto B_b;
  label B_i:
  b = 14;
  d = 4;
  goto B_b;
  label B_h:
  b = 14;
  d = 6;
  goto B_b;
  label B_c:
  b = 12;
  d = 6;
  label B_b:
  nb[0]:int = d;
  round_val[0]:int = b;
  label B_a:
  d = round_val[0]:int;
  if (c > 192255) goto B_m;
  if (c == 128192) goto B_l;
  if (c == 128256) goto B_k;
  b = 4;
  if (c == 192192) goto B_l;
  goto B_j;
  label B_m:
  if (c == 192256) goto B_k;
  if (c == 256256) goto B_k;
  b = 4;
  if (c != 256192) goto B_j;
  label B_l:
  b = 6;
  goto B_j;
  label B_k:
  b = 8;
  label B_j:
  var e:int = b;
  var f:int = e * d;
  b = 0;
  loop L_n {
    b = a + ((g = b) << 4);
    b[0] = b[0] ^ (d = word + (g + f << 2))[0];
    h = b + 4;
    h[0] = h[0] ^ (d + 480)[0]:int;
    h = b + 8;
    h[0] = h[0] ^ (d + 960)[0]:int;
    b = b + 12;
    b[0] = b[0] ^ (d + 1440)[0]:int;
    d = g + 1;
    b = d;
    if (d != e) continue L_n;
  }
  InversShiftRow_ByteSub(a, nb[0]:int);
  b = round_val[0]:int;
  if (b < 2) goto B_o;
  b = b;
  loop L_p {
    AddRoundKey_InversMixColumn(a, (d = nb)[0], b = (g = b) + -1);
    InversShiftRow_ByteSub(a, d[0]);
    b = b;
    if (g > 2) continue L_p;
  }
  label B_o:
  if (c > 192255) goto B_t;
  if (c == 128192) goto B_s;
  if (c == 128256) goto B_r;
  b = 4;
  if (c == 192192) goto B_s;
  goto B_q;
  label B_t:
  if (c == 192256) goto B_r;
  if (c == 256256) goto B_r;
  b = 4;
  if (c != 256192) goto B_q;
  label B_s:
  b = 6;
  goto B_q;
  label B_r:
  b = 8;
  label B_q:
  e = b;
  b = 0;
  loop L_u {
    d = word;
    b = a + ((g = b) << 4);
    b[0] = b[0] ^ (d = d + (g << 2))[0];
    h = b + 4;
    h[0] = h[0] ^ (d + 480)[0]:int;
    h = b + 8;
    h[0] = h[0] ^ (d + 960)[0]:int;
    b = b + 12;
    b[0] = b[0] ^ (d + 1440)[0]:int;
    d = g + 1;
    b = d;
    if (d != e) continue L_u;
  }
  b = 0;
  d = main_result[0]:int;
  loop L_v {
    h = (memory_base + 64 + (g = (b = b) << 2))[0]:int;
    g = (a + g)[0]:int;
    main_result[0]:int = (d = d + (g != h));
    g = b + 1;
    b = g;
    d = d;
    if (g != 16) continue L_v;
  }
  return 0;
}

export function InversShiftRow_ByteSub(a:int_ptr, b:int_ptr) {
  var e:int;
  var c:int;
  var d:int;
  br_table[B_e, B_a, B_d, B_a, B_c, ..B_a](b + -4)
  label B_e:
  c = a[9];
  b = invSbox;
  d = a[13];
  a[13] = (b + (c << 2 & -64))[c & 15]:int;
  c = a[5];
  a[5] = (b + ((e = a[1]) << 2 & -64))[e & 15]:int;
  a[9] = (b + (c << 2 & -64))[c & 15]:int;
  a[1] = (b + (d << 2 & -64))[d & 15]:int;
  c = a[14];
  a[14] = (b + ((d = a[6]) << 2 & -64))[d & 15]:int;
  a[6] = (b + (c << 2 & -64))[c & 15]:int;
  c = a[2];
  a[2] = (b + ((d = a[10]) << 2 & -64))[d & 15]:int;
  a[10] = (b + (c << 2 & -64))[c & 15]:int;
  c = a[15];
  a[15] = (b + ((d = a[3]) << 2 & -64))[d & 15]:int;
  a[3] = (b + ((d = a[7]) << 2 & -64))[d & 15]:int;
  d = a[11];
  a[11] = (b + (c << 2 & -64))[c & 15]:int;
  a[7] = (b + (d << 2 & -64))[d & 15]:int;
  a[0] = (b + ((c = a[0]) << 2 & -64))[c & 15]:int;
  a[4] = (b + ((c = a[4]) << 2 & -64))[c & 15]:int;
  a[8] = (b + ((c = a[8]) << 2 & -64))[c & 15]:int;
  a = a + 48;
  goto B_b;
  label B_d:
  c = a[17];
  b = invSbox;
  d = a[21];
  a[21] = (b + (c << 2 & -64))[c & 15]:int;
  c = a[13];
  a[13] = (b + ((e = a[9]) << 2 & -64))[e & 15]:int;
  a[17] = (b + (c << 2 & -64))[c & 15]:int;
  a[9] = (b + ((c = a[5]) << 2 & -64))[c & 15]:int;
  a[5] = (b + ((c = a[1]) << 2 & -64))[c & 15]:int;
  a[1] = (b + (d << 2 & -64))[d & 15]:int;
  c = a[22];
  a[22] = (b + ((d = a[14]) << 2 & -64))[d & 15]:int;
  a[14] = (b + ((d = a[6]) << 2 & -64))[d & 15]:int;
  a[6] = (b + (c << 2 & -64))[c & 15]:int;
  c = a[18];
  a[18] = (b + ((d = a[10]) << 2 & -64))[d & 15]:int;
  d = a[2];
  a[2] = (b + (c << 2 & -64))[c & 15]:int;
  a[10] = (b + (d << 2 & -64))[d & 15]:int;
  c = a[15];
  a[15] = (b + ((d = a[3]) << 2 & -64))[d & 15]:int;
  a[3] = (b + (c << 2 & -64))[c & 15]:int;
  c = a[19];
  a[19] = (b + ((d = a[7]) << 2 & -64))[d & 15]:int;
  a[7] = (b + (c << 2 & -64))[c & 15]:int;
  c = a[23];
  a[23] = (b + ((d = a[11]) << 2 & -64))[d & 15]:int;
  a[11] = (b + (c << 2 & -64))[c & 15]:int;
  a[0] = (b + ((c = a[0]) << 2 & -64))[c & 15]:int;
  a[4] = (b + ((c = a[4]) << 2 & -64))[c & 15]:int;
  a[8] = (b + ((c = a[8]) << 2 & -64))[c & 15]:int;
  a[12] = (b + ((c = a[12]) << 2 & -64))[c & 15]:int;
  a[16] = (b + ((c = a[16]) << 2 & -64))[c & 15]:int;
  a = a + 80;
  goto B_b;
  label B_c:
  c = a[25];
  b = invSbox;
  d = a[29];
  a[29] = (b + (c << 2 & -64))[c & 15]:int;
  c = a[21];
  a[21] = (b + ((e = a[17]) << 2 & -64))[e & 15]:int;
  a[25] = (b + (c << 2 & -64))[c & 15]:int;
  a[17] = (b + ((c = a[13]) << 2 & -64))[c & 15]:int;
  a[13] = (b + ((c = a[9]) << 2 & -64))[c & 15]:int;
  a[9] = (b + ((c = a[5]) << 2 & -64))[c & 15]:int;
  a[5] = (b + ((c = a[1]) << 2 & -64))[c & 15]:int;
  a[1] = (b + (d << 2 & -64))[d & 15]:int;
  c = a[30];
  a[30] = (b + ((d = a[18]) << 2 & -64))[d & 15]:int;
  a[18] = (b + ((d = a[6]) << 2 & -64))[d & 15]:int;
  a[6] = (b + ((d = a[26]) << 2 & -64))[d & 15]:int;
  a[26] = (b + ((d = a[14]) << 2 & -64))[d & 15]:int;
  a[14] = (b + ((d = a[2]) << 2 & -64))[d & 15]:int;
  a[2] = (b + ((d = a[22]) << 2 & -64))[d & 15]:int;
  d = a[10];
  a[10] = (b + (c << 2 & -64))[c & 15]:int;
  a[22] = (b + (d << 2 & -64))[d & 15]:int;
  c = a[31];
  a[31] = (b + ((d = a[15]) << 2 & -64))[d & 15]:int;
  a[15] = (b + (c << 2 & -64))[c & 15]:int;
  c = a[27];
  a[27] = (b + ((d = a[11]) << 2 & -64))[d & 15]:int;
  a[11] = (b + (c << 2 & -64))[c & 15]:int;
  c = a[23];
  a[23] = (b + ((d = a[7]) << 2 & -64))[d & 15]:int;
  a[7] = (b + (c << 2 & -64))[c & 15]:int;
  c = a[19];
  a[19] = (b + ((d = a[3]) << 2 & -64))[d & 15]:int;
  a[3] = (b + (c << 2 & -64))[c & 15]:int;
  a[0] = (b + ((c = a[0]) << 2 & -64))[c & 15]:int;
  a[4] = (b + ((c = a[4]) << 2 & -64))[c & 15]:int;
  a[8] = (b + ((c = a[8]) << 2 & -64))[c & 15]:int;
  a[12] = (b + ((c = a[12]) << 2 & -64))[c & 15]:int;
  a[16] = (b + ((c = a[16]) << 2 & -64))[c & 15]:int;
  a[20] = (b + ((c = a[20]) << 2 & -64))[c & 15]:int;
  a[24] = (b + ((c = a[24]) << 2 & -64))[c & 15]:int;
  a = a + 112;
  label B_b:
  b = a;
  a = b[0];
  b[0] = (invSbox + (a << 2 & -64))[a & 15]:int;
  label B_a:
}

export function AddRoundKey_InversMixColumn(a:int, b:int, c:int_ptr):int {
  var f:int_ptr;
  var g:int_ptr;
  var h:int_ptr;
  var e:int;
  var j:int;
  var k:int;
  var l:int;
  var d:int = stack_pointer - 128;
  if (b < 1) goto B_a;
  e = c * b;
  c = 0;
  loop L_b {
    c = a + ((f = c) << 4);
    c[0] = c[0] ^ (g = word + (f + e << 2))[0];
    h = c + 4;
    h[0] = h[0] ^ (g + 480)[0]:int;
    h = c + 8;
    h[0] = h[0] ^ (g + 960)[0]:int;
    c = c + 12;
    c[0] = c[0] ^ (g + 1440)[0]:int;
    g = f + 1;
    c = g;
    if (g != b) continue L_b;
  }
  label B_a:
  if (b <= 0) goto B_c;
  c = 0;
  loop L_d {
    var i:int = c;
    c = i << 2;
    g = 0;
    loop L_e {
      f = d + (h = (g = g) + c << 2);
      f[0] =
        (j = 
           select_if(
             (e = 
                (h = 
                   select_if((j = (e = select_if((e = (h = (a + h)[0]:int) << 1) ^ 283,
                                                 e,
                                                 (h & 2147483520) == 128) ^
                                       h) <<
                                  1) ^
                             283,
                             j,
                             (e & 2147483520) == 128) ^
                   h) <<
                1) ^
             283,
             e,
             (h & 2147483520) == 128));
      f[0] =
        (j = 
           ((h = a[((e = g + 1) & 3) | c]:int) ^
            select_if(
              (k = 
                 (h = 
                    h ^
                    select_if(
                      (l = 
                         (k = select_if((k = h << 1) ^ 283, k, (h & 2147483520) == 128)) << 1) ^
                      283,
                      l,
                      (k & 2147483520) == 128)) <<
                 1) ^
              283,
              k,
              (h & 2147483520) == 128)) ^
           j);
      f[0] =
        (h = 
           (select_if(
              (l = 
                 (k = 
                    select_if(
                      (l = (k = select_if((k = (h = a[(g + 2 & 3) | c]:int) << 1) ^ 283,
                                          k,
                                          (h & 2147483520) == 128) ^
                                h) <<
                           1) ^
                      283,
                      l,
                      (k & 2147483520) == 128)) <<
                 1) ^
              283,
              l,
              (k & 2147483520) == 128) ^
            h) ^
           j);
      f[0] =
        (select_if(
           (k = 
              (j = 
                 select_if(
                   (k = (j = select_if((j = (g = a[(g + -1 & 3) | c]:int) << 1) ^ 283,
                                       j,
                                       (g & 2147483520) == 128)) <<
                        1) ^
                   283,
                   k,
                   (j & 2147483520) == 128)) <<
              1) ^
           283,
           k,
           (j & 2147483520) == 128) ^
         g) ^
        h;
      g = e;
      if (e != 4) continue L_e;
    }
    g = i + 1;
    c = g;
    if (g != b) continue L_d;
  }
  label B_c:
  if (b <= 0) goto B_f;
  c = 0;
  loop L_g {
    (a + (c = (g = c) << 4))[0]:int = (d + c)[0]:int;
    (a + (f = c | 4))[0]:int = (d + f)[0]:int;
    (a + (f = c | 8))[0]:int = (d + f)[0]:int;
    (a + (c = c | 12))[0]:int = (d + c)[0]:int;
    g = g + 1;
    c = g;
    if (g != b) continue L_g;
  }
  label B_f:
  return 0;
}

export function SubByte(a:int):int {
  var b:int;
  return (Sbox + ((b = a / 16) << 6))[a - (b << 4)]:int;
}

export function aes_main():int {
  var a:{ a:long, b:long, c:long, d:long, e:long, f:long, g:long, h:long } = 
    statemt;
  a.h = 223338299399L;
  a.g = 236223201504L;
  a.f = 695784702104L;
  a.e = 210453397553L;
  a.d = 605590388784L;
  a.c = 386547056776L;
  a.b = 721554505974L;
  a.a = 287762808882L;
  var b:{ a:long, b:long, c:long, d:long, e:long, f:long, g:long, h:long } = 
    key;
  b.h = 257698037839L;
  b.g = 889058230281L;
  b.f = 584115552277L;
  b.e = 1060856922283L;
  b.d = 712964571346L;
  b.c = 747324309544L;
  b.b = 94489280533L;
  b.a = 541165879339L;
  encrypt(a, b, 128128);
  decrypt(a, b, 128128);
  return 0;
}

export function submain():int {
  var b:{ a:long, b:long, c:long, d:long, e:long, f:long, g:long, h:long }
  var f:double;
  var a:int = stack_pointer - 64;
  stack_pointer = a;
  main_result[0]:int = 0;
  b = gettimeofday(a + 48, 0);
  if (eqz(b)) goto B_a;
  a[8]:int = b;
  iprintf(memory_base + 2304, a + 32);
  label B_a:
  b = statemt;
  b.h = 223338299399L;
  b.g = 236223201504L;
  b.f = 695784702104L;
  b.e = 210453397553L;
  b.d = 605590388784L;
  b.c = 386547056776L;
  b.b = 721554505974L;
  b.a = 287762808882L;
  var c:{ a:long, b:long, c:long, d:long, e:long, f:long, g:long, h:long } = 
    key;
  c.a = 541165879339L;
  c.b = 94489280533L;
  c.c = 747324309544L;
  c.d = 712964571346L;
  c.e = 1060856922283L;
  c.f = 584115552277L;
  c.g = 889058230281L;
  c.h = 257698037839L;
  var d:int = a[14]:int;
  var e:long = a[6]:long;
  startTimer[0]:double =
    f64_convert_i32_s(d) * 0.000001 + f64_convert_i64_s(e);
  encrypt(b, c, 128128);
  decrypt(b, c, 128128);
  b = gettimeofday(a + 48, 0);
  if (eqz(b)) goto B_b;
  a[4]:int = b;
  iprintf(memory_base + 2304, a + 16);
  label B_b:
  b = a[14]:int;
  e = a[6]:long;
  endTimer[0]:double =
    (f = f64_convert_i32_s(b) * 0.000001 + f64_convert_i64_s(e));
  a[0]:double = f - startTimer[0]:double;
  small_printf(memory_base + 2339, a);
  b = main_result[0]:int;
  stack_pointer = a + 64;
  return b;
}

